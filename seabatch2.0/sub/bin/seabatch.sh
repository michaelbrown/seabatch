#!/bin/bash




###########################################################################
###########################################################################
#Source the contents of SEABATCH_CONFIGURATION_DIRECTORY.

for SEABATCH_CONFIGURATION_FILE in $SEABATCH_CONFIGURATION_DIRECTORY/*; do
	source $SEABATCH_CONFIGURATION_FILE
done
###########################################################################
###########################################################################




###########################################################################
###########################################################################
#

DATE=$(date +"%Y-%m-%d_%H-%M-%S")

SEABATCH_LOG_DIRECTORY='seabatch_log_'${DATE}
mkdir $SEABATCH_LOG_DIRECTORY

SEABATCH_LOG_FILE=${SEABATCH_LOG_DIRECTORY}'/seabatch_log_'${DATE}'.txt'

SEABATCH_PARAMETER_FILE=${1:-${SEABATCH}'/seabatch_parameter_file.txt'}
###########################################################################
###########################################################################




###########################################################################
###########################################################################
#Display the SeaBatch start-up text.

seabatch_startup 2>&1 | tee -a $SEABATCH_LOG_FILE
###########################################################################
###########################################################################




###########################################################################
###########################################################################
#
	
${SEABATCH_BIN_DIRECTORY}'/run_seabatch.sh' $SEABATCH_LOG_DIRECTORY $SEABATCH_PARAMETER_FILE 2>&1 | tee -a $SEABATCH_LOG_FILE
###########################################################################
###########################################################################




###########################################################################
###########################################################################
#

SEABATCH_EXIT_STATUS=${PIPESTATUS[0]} 

exit_seabatch 2>&1 | tee -a $SEABATCH_LOG_FILE

exit $SEABATCH_EXIT_STATUS
###########################################################################
###########################################################################
